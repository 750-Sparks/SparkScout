<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEX Robotics Competition Search Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>VEX Robotics Competition Search Results</h1>
    <p id="result"></p>
    <ul id="competitionList"></ul>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // Fetch and display search results
        const searchQuery = new URLSearchParams(window.location.search).get("search");
        if (searchQuery) {
            document.getElementById("result").innerText = "Results for: " + decodeURIComponent(searchQuery);

            // Simulate filtering competitions based on the search query
            const competitions = [
                { id: 1, name: "VEX High Stakes", loc_city: "New York", loc_region: "New York", start_date: "2025-04-12" },
                { id: 2, name: "VEX Camden Catholic High School", loc_city: "Camden", loc_region: "New Jersey", start_date: "2025-01-25" },
                { id: 3, name: "VEX Regional", loc_city: "Chicago", loc_region: "Illinois", start_date: "2025-06-15" },
                { id: 4, name: "VEX State Championship", loc_city: "Princeton", loc_region: "New Jersey", start_date: "2025-03-10" },
                { id: 5, name: "VEX World Championship", loc_city: "Dallas", loc_region: "Texas", start_date: "2025-07-05" }
            ];

            const filteredCompetitions = competitions.filter(comp =>
                comp.name.toLowerCase().includes(searchQuery.toLowerCase())
            );

            const list = document.getElementById("competitionList");
            if (filteredCompetitions.length > 0) {
                filteredCompetitions.forEach(comp => {
                    const item = document.createElement("li");
                    item.innerHTML = `
                        <strong>${comp.name}</strong>
                        <span>Location: ${comp.loc_city}, ${comp.loc_region}</span>
                        <span>Date: ${comp.start_date}</span>
                        <button onclick="handleViewTeams(${comp.id})">View Teams</button>
                    `;
                    list.appendChild(item);
                });
            } else {
                list.innerHTML = "<li class='no-results'>No competitions found.</li>";
            }
        } else {
            document.getElementById("result").innerText = "No search term provided.";
            alert("Please go back and enter a search term.");
            window.location.href = "/";
        }

        // Handle "View Teams" button click
        function handleViewTeams(eventId) {
            window.location.href = `/teams?eventId=${eventId}`;
        }
    </script>
</body>
</html>